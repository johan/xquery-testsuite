<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Guidelines for XPath and XQuery Full Text 1.0 Test Suite Submissions</title>
<style type="text/css">
<!--
.style1 {
	color: #000000
}
-->
</style>
</head>
<body>
<p><img alt="W3C" src="http://www.w3.org/Icons/WWW/w3c_home.gif" /></p>
<h1 style="text-align: center;">Guidelines for XPath and XQuery Full Text 1.0 Test Suite Submissions</h1>
<h2>Licensing Issues and Acceptance</h2>
<ul type="disc">
<li>Tests submissions must use the <a href=
"http://www.w3.org/2002/09/wbs/1/testgrants2-200409/">Grant II:
Grant of License for Contributed test Cases Published Outside a W3C
Recommendation</a>. This license grant, for non-participant
test case Contributors, is described <a href="http://www.w3.org/2004/10/27-testcases.html">Policies for Contribution of Test Cases to W3C</a>.</li>
<li>The XML Query Working Group and XSL Working Group will, at their sole discretion, determine
what tests are incorporated in the test suite.</li>
</ul>
<h2><b>Conformance to Schemas and File Format</b></h2>
<ul type="disc">
<li>Submissions must be valid with respect to "XQFTTSCatalog.xsd" schema file.</li>
<li>All submissions must be in a ZIP, tar or gzip file formats.</li>
<li>Please add your test cases to the "XQFTTSCatalogSubmission.xml" document that we have provided.</li>
</ul>
<h2><b>Test Structure</b></h2>
<ul type="disc">
<li>Entries in the catalogue file <strong>should</strong> contain citations of document sections, using both the section number and section name,
whenever possible. This practice is highly recommended.  A typical test catalogue entry is illustrated below.</li>
</ul>
<table style = "solid" border = "1"  align="center">
<tr>
<td>&lt;test-case name="test001" FilePath="ftor" ... &gt;<br/>
  ...<br/>
  &lt;query name="test001.xq" date="2007-12-25"&gt;<br/>
   &lt;description&gt;Test of Full Text &quot;or&quot; operator &lt;/description&gt;<br/>
  &lt;/query&gt;<br/>
  &lt;input-file role="principal-data" context="default" variable="input-context"&gt;TreeCompass&lt;/input-file&gt;<br/>
  &lt;output-file role="principal" compare="XML"&gt;test001.xml&lt;/output-file&gt;<br/>
 &lt;/test-case&gt;<br/>
</td>
</tr>
</table>
<ul type="disc">
<li>Tests for which the &lt;input-file&gt; element in the catalog file references the "emptydoc" file are not required
to make any variable mapping back to the &lt;input-file&gt; element.</li>
<li>Submitters <strong>should</strong> indicate any potential problems with the
tests.</li>
<li>Negatives tests will be accepted. However, they <strong>must</strong> be
identified as such in the catalog file.  Please see the <a href="#Error-Tests">Error Tests</a> Section below for futher
information.  A typical negative test is illustrated below:</li>
</ul>
<p></p>
<table style = "solid"  border= "1" align="center">
<tr>
<td>
  <p>(:  Name:  test001 :)<br/>
  (: Test Description:  window qualfier with non-numeric argument :)<br />
  (: Pass the string 'five' to external variable $var :) <br />
  declare $var external<br />
  /book/title ftcontains "web" ftand "site"<br />
  ftand "usability" window {$var} words</p>
  </td>
</tr>
</table>
<ul type="disc">
<li>Variable names, function names, etc., <strong>should not</strong> contain any
copyrighted information or any company name or any other text
identifying a company.</li>
<li>Submitted tests <strong>should</strong> be minimal in nature and independent of
one another.</li>
<li>Submitted tests <strong>must</strong> at least include a &ldquo;Name&rdquo;
comment and a &ldquo;Description&rdquo; comment. These
comments <strong>must</strong> appear as the first two lines of the file.</li>
<li>Submitters <strong>should</strong> reuse existing input files whenever
possible.</li>
<li>Submitted tests <strong>should</strong> be insensitive to boundary-space, that is, in direct 
element constructors there should be no boundary space between open/close tags and enclosed 
expression.</li>
<li>Tests involving the decimal and integer data types <strong>should</strong> use no more than 18 digits.</li>
<li>Test involving the data types xs:date, xs:time, xs:dateTime, xs:gYear, xs:gYearMonth,
the maximum value of the year component <strong>should</strong> be no more than 4 digits, and the maximum number of
fractional second digits <strong>must</strong> be no more than 3.</li>
<li>For tests involving the int, long, short and byte data types, please see the <a href="http://www.w3.org/TR/xmlschema-2/">Schema</a> specifications for limits 
on those data types.</li> 
<li>For tests cases that are sensitive to typed values, submittors will provide a result for 
both the typed and untyped data.</li>
<li>For test cases where typed data is imperative, submittors will need to use 
constructor functions instead of relying on typed data.</li>
<li>Submitted tests for a particular section <strong>must</strong> include only
functionality defined by that section and by the provided
required features. </li>
</ul>
<h2>Languages, Collations, and URIs</h2>
<ul type="disc">
<li>When no language is specified, English is assumed. Tests <strong>must</strong> be written with that in mind. </li>
<li>When no collation is specified, the Unicode-Codepoint collation
  is assumed. Tests <strong>should</strong> be written with that in mind.</li>
<li>URI&rsquo;s <strong>must</strong> be based on the <a href="http://www.example.com/">www.example.com</a> domain.</li>
</ul>
<h2>Static Typing</h2>
<ul type="disc">
<li>Submitted tests <strong>should</strong> obey the Static Typing rules, except for
tests intended to evaluate violations of the Static Typing
rules.</li>
<li>Submitted tests <strong>must</strong> not rely on any static typing
extensions.</li>
</ul>
<h2>Optional Features and vendor Specific Features</h2>
<ul type="disc">
<li>Submitted tests that evaluate non-optional features <strong>should not</strong> use optional features.</li>
<li>Submitted tests <strong>should not</strong> include any vendor specific
extensions (pragmas).</li>
</ul>
<h2>Error Tests</h2>
<p>Error conditions that can be mapped to the conditions specified
in the appendices of the Full Text specification <strong>should</strong> include the
error code stated for that condition. The following example
from the catalog file illustrates one of such conditions:</p>
<table style="solid" border = "1" width = "905" align="center">
<tr>
<td width="6120" align = "left"><pre class="style1">&lt;test-case is-XPath2=&quot;true&quot; name=&quot;ft-3.4.1-examples-q1&quot; FilePath=&quot;Examples/3.4.1-LanguageOption/&quot;
           scenario=&quot;standard&quot; Creator=&quot;Full-Text Task Force&quot;&gt;
  &lt;description&gt;Query where the language option is used to select the appropriate stop word list.&lt;/description&gt;
  &lt;spec-citation spec=&quot;XQueryFullText&quot; section-number=&quot;3.4.1&quot; section-title=&quot;Language Option&quot;
                 section-pointer=&quot;ftlanguageoption&quot;/&gt;
  &lt;query name=&quot;ft-3.4.1-examples-q1&quot; date=&quot;2008-08-21&quot;/&gt;
  &lt;input-file role=&quot;principal-data&quot; variable=&quot;input-context&quot;&gt;FT-3-examples-source-document&lt;/input-file&gt;
  &lt;output-file role=&quot;principal&quot; compare=&quot;Fragment&quot;&gt;ft-3.4.1-examples-results-q1.txt&lt;/output-file&gt;
  &lt;expected-error&gt;FTST0013&lt;/expected-error&gt;
&lt;/test-case&gt; </pre>  </td>
</tr>
</table>
<p>For error conditions for which there is not a predefined code, the &quot;*&quot; symbol should be used.</p>
<h2><a id ="External-Variables-Tests" name = "External-Variables-Tests"></a>External Variable Tests</h2>
<p>External variable tests are designed to run queries whose external variable values are defined by outsite
  agents.  The main catalog must define an &lt;input-query&gt; element.  The results of the input query or queries are bound to
  external variables defined in the main query.  The &lt;input-query&gt; element requires three attributes:</p>
<ol>
  <li>name - specifies the name of the input query (no extension required).</li>
  <li>variable - the name of the variable to which the results of the query should be binded.</li>
  <li>date - the date the query was written.</li>
</ol>
<p>The following example illustrates a possible entry for an external variable test case:</p>
<table style="text-align: left; width: 750px; height: 47px;" border="2"
 cellpadding="2" cellspacing="2">
  <tbody>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-size: 10pt; font-family: Courier; color: black;"> &nbsp;&nbsp;&lt;test-case name=&quot;extvardeclwithtype-17&quot; ...&gt;<br/>
        &nbsp;&nbsp;&nbsp;&lt;description&gt;External Variable used to evaluate a boolean expression ... .&lt;/description&gt;<br/>
        &nbsp;&nbsp;&nbsp;&lt;spec-citation spec=&quot;XQuery&quot; section-number=&quot;4.14&quot; ... /&gt;<br/>
        &nbsp;&nbsp;&nbsp;&lt;state time = &quot;0&quot;&gt;<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;&lt;query name=&quot;extvardeclwithtype-17&quot; date=&quot;2006-02-09&quot;/&gt;<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;&lt;input-file role=&quot;principal-data&quot; variable=&quot;input-context&quot;&gt;emptydoc&lt;/input-file&gt;<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;&lt;input-query variable=&quot;x&quot; name=&quot;extvardeclwithtypetobind-17&quot; date=&quot;2006-02-09&quot;/&gt;<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;&lt;output-file role=&quot;principal&quot; compare=&quot;Text&quot;&gt;extvardeclwithtype-17.txt&lt;/output-file&gt;<br/>
        &nbsp;&nbsp;&nbsp;&lt;/state&gt;<br/>
        &nbsp;&nbsp;&lt;/test-case&gt; </span></td>
    </tr>
  </tbody>
</table>
<p>The following are the input query and the main query that corresponds to the entry above:</p>
<table style="text-align: left; width: 750px; height: 47px;" border="2"
 cellpadding="2" cellspacing="2">
  <tbody>
    <tr>
      <td style="vertical-align: top;"><span
 style="font-size: 10pt; font-family: Courier; color: black;">Input Query<br/>
            <br/>
        &nbsp;&nbsp;&nbsp;(: Name: extvardeclwithtypetobind-17 :)<br/>
        &nbsp;&nbsp;&nbsp;(: Description: Binding boolean expression for extvardeclwithtype-17.:)<br/>
        <br/>
        &nbsp;&nbsp;&nbsp;let $var := fn:true() or fn:true()<br/>
        &nbsp;&nbsp;&nbsp;return $var<br/>
        <br/>
        Main Query<br/>
        <br/>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(: Name: extvardeclwithtype-17 :)<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(: Description: Evaluates an external variable used in a boolean expression:)<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(: Both queries perform the operation. :)<br/>
        <br/>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;declare variable $x as xs:boolean external;<br/>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$x or fn:false()<br/>
      </span></td>
    </tr>
  </tbody>
</table>
<p>Note the name(s) of the external variable(s) defined in the main query must match the names of the 
  variable(s) defined in the input queries (&quot;x&quot; in this case).  The main query must be a stand alone query;
  it should have no input infosets.  At this point, it is not forseen that a lot of tests will be available for the
  Full Text test suite.</p>
<h2>XML and Namespaces</h2>
<ul type="disc">
<li>Submitted tests <strong>should</strong> be independent of XML versions
&ldquo;1.0&rdquo; and &ldquo;1.1&rdquo; and XML Namespaces versions
&ldquo;1.0&rdquo; and &ldquo;1.1&rdquo; features unless the purpose
is to evaluate those features.</li>
</ul>
<h2>XML Encoding</h2>
<ul type="disc">
<li>Submitted tests <strong>should</strong> use UTF-8 encoding.</li>
</ul>
<h2>Related Specifications</h2>
<ul type="disc">
<li>Submitted tests <strong>should</strong> be based exclusively on the XQuery and XPath Full Text 1.0 specification and the main XQuery specification. Some tests may rely   on the Formal Semantics, Data Model, Functions and Operators, and Serialization documents;   however those specifications are not being directly tested.</li>
</ul>
<h2>XPath Compatibility</h2>
<ul type="disc">
<li>The test-group element in the catalog may have the optional
attribute is-XPath2="no". If this attribute is not present,
when it is assumed that all descendent test cases may or may not be
XPath 2.0 tests.</li>
<li>The test-case element in the catalog may have the optional
attribute is-XPath2="yes|no". If this attribute is not
present, then it is assumed that this test case may or may not be
an XPath 2.0 test. If any test-group ancester of this element
has is-XPath2="no", then this test-case element cannot have
is-XPath2="yes". Over time, all test-case elements will have
this attribute defined.</li>
</ul>
<h2>Results and Serialization</h2>
<ul type="disc">
<li>Tests in the XQFTTS test suite rely on the serialized form of the test
result in order to check correctness. Thus, any feature whose effect is
not captured as part of the serialized result of a query, <strong>should </strong>be
explicitly checked as part of the test query itself. For example, typing
information is not present in the serialized results of an XQuery
expression.</li>
</ul>
<h2>Expected Results</h2>
<ul type="disc">
<li>Submitters <strong>must</strong> provide expected results for all submitted
tests.</li>
<li>When serializing content of a typed element where the type is
atomic, any lexical representation of the value may be serialized.
To minimize the number of expected results per test case, the
input value used to construct the typed element should be identical
to the result if this input value was cast to xs:string. If
this is true, then only one expected result with the serialized
value in its original lexical form is required for this test case.
However, if the intent of the testcase is to test other
lexical representations, then two expected results must be created
where one result would contain the value if it was cast to
xs:string, and the other in its original lexical form</li>
<li>Some tests involve operations on floats/doubles and coverting those results to  strings. Even as one explicit value is given, the task force realizes that  other values may also be acceptable. In such cases, submitters are encouraged  to submit values that may differ.  The task force will eventually determine  if such values are within the acceptable range.</li>
</ul>
<hr /> 
<address> 
  <a href="http://www.w3.org/Help/Webmaster">Webmaster</a> · Last modified: 
  $Date: 2009/02/16 00:57:16 $ by $Author: jmelton $ 
</address> 
<p><a rel="Copyright" 
href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> 
© 1994-2009 <a href="http://www.w3.org/"><acronym 
title="World Wide Web Consortium">W3C</acronym></a><sup>®</sup> (<a 
href="http://www.csail.mit.edu/"><acronym 
title="Massachusetts Institute of Technology">MIT</acronym></a>, <a 
href="http://www.ercim.org/"><acronym 
title="European Research Consortium for Informatics and Mathematics">ERCIM</acronym></a>, 
<a href="http://www.keio.ac.jp/">Keio</a>), All Rights Reserved. W3C <a 
href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, 
<a 
href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a>, 
<a rel="Copyright" 
href="http://www.w3.org/Consortium/Legal/copyright-documents">document 
use</a> and <a rel="Copyright" 
href="http://www.w3.org/Consortium/Legal/copyright-software">software 
licensing</a> rules apply. Your interactions with this site are in accordance 
with our <a 
href="http://www.w3.org/Consortium/Legal/privacy-statement#Public">public</a> 
and <a 
href="http://www.w3.org/Consortium/Legal/privacy-statement#Members">Member</a> 
privacy statements.</p> 
</body>
</html>
